# Building LabCart for Mac

## Prerequisites

On your Mac, you need:
- Node.js 20+ installed
- Xcode Command Line Tools (`xcode-select --install`)

## Build Steps

1. **Clone/copy this repo to your Mac**

2. **Install dependencies:**
```bash
cd labcart
npm install
```

3. **Build the Mac app:**
```bash
npm run build:mac
```

This will:
- Build the Next.js production bundle
- Package it with Electron
- Create both a DMG installer and ZIP archive in `dist/`

Output files will be in `dist/`:
- `LabCart-<version>.dmg` - Drag-and-drop installer
- `LabCart-<version>-mac.zip` - Direct app bundle

## Quick Test (Dev Mode)

To test before building:

**Terminal 1** - Start Next.js dev server:
```bash
npm run dev
```

**Terminal 2** - Start Electron (wait for Next.js to be ready):
```bash
npm run electron:dev
```

## What's Included

- **Native folder picker** - macOS native directory selection dialog
- **Background bot server** - Automatically starts with the app
- **Auto-updates ready** - electron-builder includes update framework
- **Signed and notarized** (when you add Apple Developer credentials)

## Code Signing (Optional)

For distribution outside your team, you'll need to sign the app:

1. Get an Apple Developer account ($99/year)
2. Create certificates in Xcode
3. Add to package.json:
```json
"build": {
  "mac": {
    "identity": "Developer ID Application: Your Name (TEAM_ID)",
    "hardenedRuntime": true,
    "entitlements": "build/entitlements.mac.plist",
    "entitlementsInherit": "build/entitlements.mac.plist"
  }
}
```

For now, you can distribute the unsigned .app for testing.

## Troubleshooting

**"App is damaged" error:**
- macOS Gatekeeper blocks unsigned apps
- Right-click → Open (first time only)
- Or: `xattr -cr LabCart.app`

**electron-builder errors:**
- Make sure you're on macOS (can't build DMG from Linux)
- Install Xcode Command Line Tools
- Clear node_modules and reinstall

## Architecture

- **electron/main.js** - Main Electron process, creates window, starts bot server
- **electron/preload.js** - Secure IPC bridge for folder picker
- **out/** - Next.js production build (generated by `npm run build`)
- **../claude-bot/** - Bot server (bundled with the app)

## Distribution

Once built:
1. Test the .app on your Mac
2. Share the DMG with your team
3. They drag LabCart.app to Applications folder
4. First launch: Right-click → Open (bypass Gatekeeper)

Later you can set up auto-updates using electron-updater + GitHub releases.
